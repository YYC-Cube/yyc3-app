# YYC3-AI åº”ç”¨å®Œæ•´éƒ¨ç½²æŒ‡å—

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: YYC3-AI-Call (AIé€šè¯åŠ©æ‰‹)
**é¡¹ç›®URL**: https://v0-yyc3-ai-call.vercel.app/
**é¡¹ç›®ç±»å‹**: å…¨æ ˆAIåº”ç”¨ (Verceléƒ¨ç½²)
**æŠ€æœ¯æ ˆåˆ†æ**: React/Vue + Node.js + AI API + æ•°æ®åº“

---

## ğŸ“‹ éƒ¨ç½²æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”Ÿäº§ç¯å¢ƒæ¶æ„                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸŒ CDN/è´Ÿè½½å‡è¡¡                                              â”‚
â”‚      â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ å‰ç«¯A  â”‚ å‰ç«¯B  â”‚ å‰ç«¯C  â”‚ å‰ç«¯D  â”‚ å‰ç«¯E  â”‚ ç®¡ç†åå° â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚      â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    APIç½‘å…³                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç”¨æˆ·æœåŠ¡     â”‚ AIå¯¹è¯æœåŠ¡    â”‚ é€šè¯æœåŠ¡     â”‚ åˆ†ææœåŠ¡     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    æ•°æ®å±‚                               â”‚ â”‚
â”‚  â”‚  PostgreSQL  Redis  MongoDB  MinIO(æ–‡ä»¶å­˜å‚¨)           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ç¬¬ä¸€é˜¶æ®µï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒéƒ¨ç½²

### 1. ç¯å¢ƒå‡†å¤‡

#### ç³»ç»Ÿè¦æ±‚
```bash
# å¼€å‘æœºé…ç½® (YYC3-22)
- CPU: 4æ ¸å¿ƒä»¥ä¸Š
- å†…å­˜: 8GBä»¥ä¸Š
- å­˜å‚¨: 100GBä»¥ä¸Š
- ç½‘ç»œ: ç¨³å®šçš„äº’è”ç½‘è¿æ¥
- ç³»ç»Ÿ: macOS/Linux/Windows with WSL2
```

#### å¿…éœ€è½¯ä»¶å®‰è£…
```bash
# 1. Node.js 18+
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# 2. Git
sudo apt-get install git

# 3. Docker & Docker Compose
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# 4. æ•°æ®åº“å·¥å…·
# PostgreSQL 15+
sudo apt-get install postgresql postgresql-contrib

# Redis
sudo apt-get install redis-server

# 5. ä»£ç ç¼–è¾‘å™¨
# VS Code + å¿…è¦æ’ä»¶
```

### 2. é¡¹ç›®å…‹éš†ä¸åˆå§‹åŒ–

```bash
# 1. åˆ›å»ºé¡¹ç›®ç›®å½•
cd /Users/yanyu/www/deployments
mkdir yyc3-ai-call
cd yyc3-ai-call

# 2. åˆå§‹åŒ–é¡¹ç›®ç»“æ„
mkdir -p {frontend,backend,docs,scripts,configs,docker}

# 3. åˆ›å»ºå‰ç«¯é¡¹ç›® (å‡è®¾æ˜¯React)
cd frontend
npx create-react-app . --template typescript
# æˆ–è€…å¦‚æœæ˜¯Vue
# npm create vue@latest .

# 4. åˆ›å»ºåç«¯é¡¹ç›®
cd ../backend
mkdir {src,tests,docs}
npm init -y
npm install express cors helmet morgan dotenv
npm install -D typescript @types/node @types/express ts-node nodemon
```

### 3. é…ç½®æ–‡ä»¶åˆ›å»º

#### åç«¯é…ç½® (`backend/.env`)
```bash
# æœåŠ¡å™¨é…ç½®
NODE_ENV=development
PORT=3001
HOST=localhost

# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=5432
DB_NAME=yyc3_ai_db
DB_USER=postgres
DB_PASSWORD=your_password

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# AI APIé…ç½®
OPENAI_API_KEY=your_openai_key
ANTHROPIC_API_KEY=your_anthropic_key

# JWTé…ç½®
JWT_SECRET=your_jwt_secret_key
JWT_EXPIRES_IN=7d

# æ–‡ä»¶å­˜å‚¨é…ç½®
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760

# å¤–éƒ¨æœåŠ¡é…ç½®
WEBHOOK_URL=http://localhost:3001/webhooks
NOTIFICATION_SERVICE_URL=http://localhost:3002/notifications
```

#### å‰ç«¯é…ç½® (`frontend/.env`)
```bash
# APIé…ç½®
REACT_APP_API_URL=http://localhost:3001
REACT_APP_WS_URL=ws://localhost:3001

# åº”ç”¨é…ç½®
REACT_APP_NAME=YYC3-AI-Call
REACT_APP_VERSION=1.0.0
REACT_APP_ENV=development

# åŠŸèƒ½å¼€å…³
REACT_APP_ENABLE_ANALYTICS=false
REACT_APP_ENABLE_DEBUG=true
REACT_APP_ENABLE_MOCK=false
```

### 4. Dockeræœ¬åœ°å¼€å‘ç¯å¢ƒ

#### `docker-compose.dev.yml`
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    container_name: yyc3-postgres-dev
    environment:
      POSTGRES_DB: yyc3_ai_db
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: dev_password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql
    networks:
      - yyc3-network

  redis:
    image: redis:7-alpine
    container_name: yyc3-redis-dev
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    networks:
      - yyc3-network

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile.dev
    container_name: yyc3-backend-dev
    ports:
      - "3001:3001"
    volumes:
      - ./backend:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development
    depends_on:
      - postgres
      - redis
    networks:
      - yyc3-network

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.dev
    container_name: yyc3-frontend-dev
    ports:
      - "3000:3000"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - REACT_APP_API_URL=http://localhost:3001
    networks:
      - yyc3-network

volumes:
  postgres_data:
  redis_data:

networks:
  yyc3-network:
    driver: bridge
```

### 5. å¯åŠ¨æœ¬åœ°å¼€å‘ç¯å¢ƒ

```bash
# 1. å¯åŠ¨æ•°æ®åº“æœåŠ¡
docker-compose -f docker-compose.dev.yml up -d postgres redis

# 2. åˆå§‹åŒ–æ•°æ®åº“
./scripts/init-database.sh

# 3. å¯åŠ¨åç«¯æœåŠ¡
cd backend
npm run dev

# 4. å¯åŠ¨å‰ç«¯æœåŠ¡ (æ–°ç»ˆç«¯)
cd frontend
npm start
```

---

## ğŸ”§ ç¬¬äºŒé˜¶æ®µï¼šåŠŸèƒ½å¼€å‘ä¸æµ‹è¯•

### 1. åç«¯APIå¼€å‘

#### `backend/src/app.ts`
```typescript
import express from 'express';
import cors from 'cors';
import helmet from 'helmet';
import morgan from 'morgan';
import dotenv from 'dotenv';
import { connectDatabase } from './config/database';
import { setupRoutes } from './routes';
import { errorHandler } from './middleware/errorHandler';

dotenv.config();

const app = express();
const PORT = process.env.PORT || 3001;

// ä¸­é—´ä»¶
app.use(helmet());
app.use(cors());
app.use(morgan('combined'));
app.use(express.json({ limit: '10mb' }));
app.use(express.urlencoded({ extended: true }));

// å¥åº·æ£€æŸ¥
app.get('/health', (req, res) => {
  res.json({
    status: 'ok',
    timestamp: new Date().toISOString(),
    environment: process.env.NODE_ENV
  });
});

// APIè·¯ç”±
setupRoutes(app);

// é”™è¯¯å¤„ç†
app.use(errorHandler);

// å¯åŠ¨æœåŠ¡å™¨
async function startServer() {
  try {
    await connectDatabase();
    app.listen(PORT, () => {
      console.log(`ğŸš€ YYC3-AI Backend running on http://localhost:${PORT}`);
    });
  } catch (error) {
    console.error('Failed to start server:', error);
    process.exit(1);
  }
}

startServer();
```

#### APIè·¯ç”±ç»“æ„
```typescript
// backend/src/routes/index.ts
import { Router } from 'express';
import authRoutes from './auth';
import aiCallRoutes from './ai-call';
import userRoutes from './user';
import analyticsRoutes from './analytics';

const router = Router();

router.use('/auth', authRoutes);
router.use('/ai-call', aiCallRoutes);
router.use('/users', userRoutes);
router.use('/analytics', analyticsRoutes);

export default router;
```

### 2. å‰ç«¯åº”ç”¨å¼€å‘

#### ä¸»è¦ç»„ä»¶ç»“æ„
```typescript
// frontend/src/components/AICallInterface.tsx
import React, { useState, useEffect } from 'react';
import { io, Socket } from 'socket.io-client';

interface Message {
  id: string;
  content: string;
  sender: 'user' | 'ai';
  timestamp: Date;
}

export const AICallInterface: React.FC = () => {
  const [messages, setMessages] = useState<Message[]>([]);
  const [isConnected, setIsConnected] = useState(false);
  const [isLoading, setIsLoading] = useState(false);

  useEffect(() => {
    // è¿æ¥WebSocket
    const socket: Socket = io(process.env.REACT_APP_WS_URL || 'http://localhost:3001');

    socket.on('connect', () => {
      setIsConnected(true);
      console.log('Connected to AI server');
    });

    socket.on('ai-response', (response) => {
      setMessages(prev => [...prev, {
        id: Date.now().toString(),
        content: response.message,
        sender: 'ai',
        timestamp: new Date()
      }]);
      setIsLoading(false);
    });

    return () => socket.close();
  }, []);

  const handleSendMessage = async (message: string) => {
    const userMessage: Message = {
      id: Date.now().toString(),
      content: message,
      sender: 'user',
      timestamp: new Date()
    };

    setMessages(prev => [...prev, userMessage]);
    setIsLoading(true);

    try {
      const response = await fetch(`${process.env.REACT_APP_API_URL}/ai-call/chat`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ message }),
      });

      if (!response.ok) {
        throw new Error('Failed to send message');
      }
    } catch (error) {
      console.error('Error sending message:', error);
      setIsLoading(false);
    }
  };

  return (
    <div className="ai-call-interface">
      <div className="connection-status">
        {isConnected ? 'ğŸŸ¢ å·²è¿æ¥' : 'ğŸ”´ è¿æ¥ä¸­...'}
      </div>

      <div className="messages-container">
        {messages.map((message) => (
          <div
            key={message.id}
            className={`message ${message.sender}`}
          >
            <div className="content">{message.content}</div>
            <div className="timestamp">
              {message.timestamp.toLocaleTimeString()}
            </div>
          </div>
        ))}
        {isLoading && <div className="typing-indicator">AIæ­£åœ¨æ€è€ƒ...</div>}
      </div>

      <MessageInput onSendMessage={handleSendMessage} disabled={isLoading} />
    </div>
  );
};
```

### 3. æ•°æ®åº“è®¾è®¡

#### ç”¨æˆ·è¡¨
```sql
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100),
    role VARCHAR(20) DEFAULT 'user',
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### AIå¯¹è¯è®°å½•è¡¨
```sql
CREATE TABLE ai_conversations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    title VARCHAR(200),
    context JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE ai_messages (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    conversation_id UUID REFERENCES ai_conversations(id) ON DELETE CASCADE,
    content TEXT NOT NULL,
    sender VARCHAR(10) NOT NULL, -- 'user' or 'ai'
    metadata JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## ğŸŒ ç¬¬ä¸‰é˜¶æ®µï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. äº‘æœåŠ¡å™¨éƒ¨ç½²æ¶æ„

#### æœåŠ¡å™¨é…ç½®è§„åˆ’
```
ç”Ÿäº§æœåŠ¡å™¨é›†ç¾¤:
â”œâ”€â”€ yyc3-121 (é˜¿é‡Œäº‘) - ä¸»åº”ç”¨æœåŠ¡å™¨
â”œâ”€â”€ yyc3-121-backup (é˜¿é‡Œäº‘:2222) - å¤‡ä»½æœåŠ¡å™¨
â”œâ”€â”€ yyc3-45 (NAS) - æ•°æ®å­˜å‚¨æœåŠ¡å™¨
â””â”€â”€ yyc3-22 (å¼€å‘æœº) - æµ‹è¯•/é¢„å‘å¸ƒæœåŠ¡å™¨
```

### 2. ç”Ÿäº§ç¯å¢ƒé…ç½®

#### `docker-compose.prod.yml`
```yaml
version: '3.8'

services:
  nginx:
    image: nginx:alpine
    container_name: yyc3-nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./nginx/ssl:/etc/nginx/ssl
      - static_files:/var/www/static
    depends_on:
      - frontend
      - backend
    networks:
      - yyc3-network
    restart: unless-stopped

  postgres:
    image: postgres:15-alpine
    container_name: yyc3-postgres
    environment:
      POSTGRES_DB: yyc3_ai_prod
      POSTGRES_USER: yyc3_admin
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./backups:/backups
    networks:
      - yyc3-network
    restart: unless-stopped

  redis:
    image: redis:7-alpine
    container_name: yyc3-redis
    command: redis-server --requirepass ${REDIS_PASSWORD}
    volumes:
      - redis_data:/data
    networks:
      - yyc3-network
    restart: unless-stopped

  backend:
    image: yyc3-ai/backend:latest
    container_name: yyc3-backend
    environment:
      - NODE_ENV=production
      - DB_HOST=postgres
      - REDIS_HOST=redis
      - JWT_SECRET=${JWT_SECRET}
    volumes:
      - ./logs:/app/logs
      - ./uploads:/app/uploads
    depends_on:
      - postgres
      - redis
    networks:
      - yyc3-network
    restart: unless-stopped
    deploy:
      replicas: 2

  frontend:
    image: yyc3-ai/frontend:latest
    container_name: yyc3-frontend
    environment:
      - REACT_APP_API_URL=https://api.yyc3-ai.com
    networks:
      - yyc3-network
    restart: unless-stopped
    deploy:
      replicas: 2

volumes:
  postgres_data:
  redis_data:
  static_files:

networks:
  yyc3-network:
    driver: bridge
```

### 3. CI/CDéƒ¨ç½²æµæ°´çº¿

#### GitHub Actionsé…ç½® (`.github/workflows/deploy.yml`)
```yaml
name: Deploy to Production

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: |
          cd frontend && npm ci
          cd ../backend && npm ci

      - name: Run tests
        run: |
          cd frontend && npm test -- --coverage --watchAll=false
          cd ../backend && npm test

  build-and-deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'

    steps:
      - uses: actions/checkout@v3

      - name: Setup Docker Buildx
        uses: docker/setup-buildx-action@v2

      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{ secrets.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_PASSWORD }}

      - name: Build and push backend
        uses: docker/build-push-action@v4
        with:
          context: ./backend
          push: true
          tags: yyc3-ai/backend:latest

      - name: Build and push frontend
        uses: docker/build-push-action@v4
        with:
          context: ./frontend
          push: true
          tags: yyc3-ai/frontend:latest

      - name: Deploy to production
        uses: appleboy/ssh-action@v0.1.5
        with:
          host: ${{ secrets.HOST }}
          username: ${{ secrets.USERNAME }}
          key: ${{ secrets.SSH_KEY }}
          script: |
            cd /opt/yyc3-ai
            docker-compose -f docker-compose.prod.yml pull
            docker-compose -f docker-compose.prod.yml up -d
            docker system prune -f
```

### 4. åŸŸåå’ŒSSLé…ç½®

#### Nginxé…ç½® (`nginx/nginx.conf`)
```nginx
events {
    worker_connections 1024;
}

http {
    upstream backend {
        server backend:3001;
    }

    # HTTPé‡å®šå‘åˆ°HTTPS
    server {
        listen 80;
        server_name yyc3-ai.com www.yyc3-ai.com;
        return 301 https://$server_name$request_uri;
    }

    # HTTPSé…ç½®
    server {
        listen 443 ssl http2;
        server_name yyc3-ai.com www.yyc3-ai.com;

        # SSLè¯ä¹¦é…ç½®
        ssl_certificate /etc/nginx/ssl/cert.pem;
        ssl_certificate_key /etc/nginx/ssl/key.pem;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;

        # å®‰å…¨å¤´
        add_header X-Frame-Options DENY;
        add_header X-Content-Type-Options nosniff;
        add_header X-XSS-Protection "1; mode=block";

        # APIä»£ç†
        location /api/ {
            proxy_pass http://backend/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # WebSocketæ”¯æŒ
        location /socket.io/ {
            proxy_pass http://backend;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }

        # å‰ç«¯é™æ€æ–‡ä»¶
        location / {
            root /var/www/static;
            try_files $uri $uri/ /index.html;
        }

        # æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
        client_max_body_size 10M;
    }
}
```

---

## ğŸ“± ç¬¬å››é˜¶æ®µï¼šå¤šç«¯æ„å»ºä¸åˆ†å‘

### 1. ç§»åŠ¨ç«¯æ„å»º

#### React Nativeé…ç½®
```bash
# 1. å®‰è£…React Native CLI
npm install -g @react-native-community/cli

# 2. åˆ›å»ºReact Nativeé¡¹ç›®
npx react-native init Yyc3AiMobile --template react-native-template-typescript

# 3. ç§»åŠ¨ç«¯é…ç½®
cd Yyc3AiMobile
npm install @react-navigation/native @react-navigation/stack
npm install axios socket.io-client
```

#### ç§»åŠ¨ç«¯éƒ¨ç½²è„šæœ¬
```bash
#!/bin/bash
# scripts/build-mobile.sh

echo "ğŸš€ å¼€å§‹ç§»åŠ¨ç«¯æ„å»º..."

# Androidæ„å»º
cd android
./gradlew assembleRelease
echo "âœ… Android APKæ„å»ºå®Œæˆ: android/app/build/outputs/apk/release/app-release.apk"

# iOSæ„å»º (åœ¨macOSä¸Š)
cd ../ios
xcodebuild -workspace Yyc3AiMobile.xcworkspace -scheme Yyc3AiMobile -configuration Release -destination generic/platform=iOS -archivePath Yyc3AiMobile.xcarchive archive
echo "âœ… iOS Archiveæ„å»ºå®Œæˆ"

echo "ğŸ‰ ç§»åŠ¨ç«¯æ„å»ºå®Œæˆ!"
```

### 2. æ¡Œé¢ç«¯æ„å»º

#### Electroné…ç½®
```bash
# 1. å®‰è£…Electron
npm install --save-dev electron electron-builder

# 2. Electronä¸»è¿›ç¨‹é…ç½®
// public/electron.js
const { app, BrowserWindow, ipcMain } = require('electron');
const path = require('path');
const isDev = require('electron-is-dev');

let mainWindow;

function createWindow() {
  mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
    }
  });

  mainWindow.loadURL(
    isDev
      ? 'http://localhost:3000'
      : `file://${path.join(__dirname, '../build/index.html')}`
  );
}

app.whenReady().then(createWindow);
```

#### æ¡Œé¢ç«¯æ„å»ºè„šæœ¬
```bash
#!/bin/bash
# scripts/build-desktop.sh

echo "ğŸš€ å¼€å§‹æ¡Œé¢ç«¯æ„å»º..."

# æ„å»ºReactåº”ç”¨
npm run build

# ä½¿ç”¨electron-builderæ‰“åŒ…
npm run electron-pack

echo "âœ… æ¡Œé¢ç«¯æ„å»ºå®Œæˆ!"
echo "ğŸ“¦ å®‰è£…åŒ…ä½ç½®: dist/"
```

### 3. å°ç¨‹åºç«¯æ„å»º

#### å¾®ä¿¡å°ç¨‹åºé…ç½®
```json
// miniprogram/app.json
{
  "pages": [
    "pages/index/index",
    "pages/chat/chat",
    "pages/profile/profile"
  ],
  "window": {
    "backgroundTextStyle": "light",
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "YYC3 AIåŠ©æ‰‹",
    "navigationBarTextStyle": "black"
  },
  "networkTimeout": {
    "request": 10000,
    "downloadFile": 10000
  }
}
```

---

## ğŸ‘¥ ç¬¬äº”é˜¶æ®µï¼šå•ä½å†…éƒ¨æµ‹è¯•éƒ¨ç½²

### 1. æµ‹è¯•ç¯å¢ƒæ­å»º

#### æµ‹è¯•æœåŠ¡å™¨é…ç½® (`docker-compose.test.yml`)
```yaml
version: '3.8'

services:
  test-frontend:
    image: yyc3-ai/frontend:test
    container_name: yyc3-test-frontend
    ports:
      - "3000:3000"
    environment:
      - REACT_APP_API_URL=http://test-api.yyc3-local.com:3001
      - REACT_APP_ENV=test
    networks:
      - test-network

  test-backend:
    image: yyc3-ai/backend:test
    container_name: yyc3-test-backend
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=test
      - DB_HOST=test-postgres
      - REDIS_HOST=test-redis
    depends_on:
      - test-postgres
      - test-redis
    networks:
      - test-network

  test-postgres:
    image: postgres:15-alpine
    container_name: yyc3-test-postgres
    environment:
      POSTGRES_DB: yyc3_ai_test
      POSTGRES_USER: test_user
      POSTGRES_PASSWORD: test_password
    volumes:
      - test_postgres_data:/var/lib/postgresql/data
      - ./test-data:/docker-entrypoint-initdb.d
    networks:
      - test-network

  test-redis:
    image: redis:7-alpine
    container_name: yyc3-test-redis
    volumes:
      - test_redis_data:/data
    networks:
      - test-network

volumes:
  test_postgres_data:
  test_redis_data:

networks:
  test-network:
    driver: bridge
```

### 2. æµ‹è¯•æ•°æ®åˆå§‹åŒ–

#### æµ‹è¯•æ•°æ®è„šæœ¬ (`scripts/init-test-data.sh`)
```bash
#!/bin/bash

echo "ğŸ”„ åˆå§‹åŒ–æµ‹è¯•æ•°æ®..."

# åˆ›å»ºæµ‹è¯•ç”¨æˆ·
docker exec yyc3-test-postgres psql -U test_user -d yyc3_ai_test << EOF
-- åˆ›å»ºæµ‹è¯•ç”¨æˆ·
INSERT INTO users (username, email, password_hash, full_name, role) VALUES
('test_admin', 'admin@yyc3.com', '\$2b\$10\$hashed_password', 'æµ‹è¯•ç®¡ç†å‘˜', 'admin'),
('test_user1', 'user1@yyc3.com', '\$2b\$10\$hashed_password', 'æµ‹è¯•ç”¨æˆ·1', 'user'),
('test_user2', 'user2@yyc3.com', '\$2b\$10\$hashed_password', 'æµ‹è¯•ç”¨æˆ·2', 'user');

-- åˆ›å»ºæµ‹è¯•å¯¹è¯
INSERT INTO ai_conversations (user_id, title, context) VALUES
((SELECT id FROM users WHERE username='test_user1'), 'æµ‹è¯•å¯¹è¯1', '{"topic": "æµ‹è¯•", "language": "zh-CN"}'),
((SELECT id FROM users WHERE username='test_user2'), 'æµ‹è¯•å¯¹è¯2', '{"topic": "AIåŠ©æ‰‹", "language": "zh-CN"}');

-- åˆ›å»ºæµ‹è¯•æ¶ˆæ¯
INSERT INTO ai_messages (conversation_id, content, sender, metadata)
SELECT
    conv.id,
    'è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯',
    'user',
    '{"test": true}'
FROM ai_conversations conv
WHERE conv.title LIKE 'æµ‹è¯•%';
EOF

echo "âœ… æµ‹è¯•æ•°æ®åˆå§‹åŒ–å®Œæˆ!"
```

### 3. æµ‹è¯•éƒ¨ç½²è„šæœ¬

#### è‡ªåŠ¨åŒ–æµ‹è¯•éƒ¨ç½² (`scripts/deploy-test.sh`)
```bash
#!/bin/bash

set -e

echo "ğŸš€ å¼€å§‹éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ..."

# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 2. æ„å»ºæµ‹è¯•é•œåƒ
echo "ğŸ“¦ æ„å»ºæµ‹è¯•é•œåƒ..."
docker build -t yyc3-ai/frontend:test ./frontend
docker build -t yyc3-ai/backend:test ./backend

# 3. åœæ­¢æ—§å®¹å™¨
echo "ğŸ”„ åœæ­¢æ—§å®¹å™¨..."
docker-compose -f docker-compose.test.yml down

# 4. å¯åŠ¨æ–°å®¹å™¨
echo "ğŸ”„ å¯åŠ¨æ–°å®¹å™¨..."
docker-compose -f docker-compose.test.yml up -d

# 5. ç­‰å¾…æœåŠ¡å¯åŠ¨
echo "â³ ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 30

# 6. åˆå§‹åŒ–æµ‹è¯•æ•°æ®
echo "ğŸ“Š åˆå§‹åŒ–æµ‹è¯•æ•°æ®..."
./scripts/init-test-data.sh

# 7. å¥åº·æ£€æŸ¥
echo "ğŸ¥ æ‰§è¡Œå¥åº·æ£€æŸ¥..."
if curl -f http://localhost:3000/health > /dev/null 2>&1; then
    echo "âœ… å‰ç«¯æœåŠ¡æ­£å¸¸"
else
    echo "âŒ å‰ç«¯æœåŠ¡å¼‚å¸¸"
    exit 1
fi

if curl -f http://localhost:3001/health > /dev/null 2>&1; then
    echo "âœ… åç«¯æœåŠ¡æ­£å¸¸"
else
    echo "âŒ åç«¯æœåŠ¡å¼‚å¸¸"
    exit 1
fi

echo "ğŸ‰ æµ‹è¯•ç¯å¢ƒéƒ¨ç½²å®Œæˆ!"
echo "ğŸŒ å‰ç«¯åœ°å€: http://localhost:3000"
echo "ğŸ”§ åç«¯API: http://localhost:3001"
```

### 4. å•ä½æµ‹è¯•æŒ‡å—

#### æµ‹è¯•ç”¨æˆ·æ‰‹å†Œ (`docs/USER_TESTING_GUIDE.md`)
```markdown
# YYC3-AI å•ä½å†…éƒ¨æµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡
1. åŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•
2. æ€§èƒ½å‹åŠ›æµ‹è¯•
3. ç”¨æˆ·ä½“éªŒæµ‹è¯•
4. å®‰å…¨æ€§æµ‹è¯•

## ğŸ‘¥ æµ‹è¯•ç”¨æˆ·åˆ†é…

### æµ‹è¯•ç”¨æˆ·1: ç®¡ç†å‘˜
- **ç”¨æˆ·å**: test_admin
- **å¯†ç **: TestAdmin123!
- **æƒé™**: ç®¡ç†å‘˜æƒé™ï¼Œå¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ•°æ®å’Œé…ç½®

### æµ‹è¯•ç”¨æˆ·2: æ™®é€šç”¨æˆ·
- **ç”¨æˆ·å**: test_user1
- **å¯†ç **: TestUser123!
- **æƒé™**: æ™®é€šç”¨æˆ·æƒé™ï¼Œåªèƒ½ä½¿ç”¨åŸºæœ¬åŠŸèƒ½

### æµ‹è¯•ç”¨æˆ·3: æ™®é€šç”¨æˆ·
- **ç”¨æˆ·å**: test_user2
- **å¯†ç **: TestUser123!
- **æƒé™**: æ™®é€šç”¨æˆ·æƒé™

## ğŸ“‹ æµ‹è¯•æ¸…å•

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- [ ] ç”¨æˆ·ç™»å½•/ç™»å‡º
- [ ] AIå¯¹è¯åŠŸèƒ½
- [ ] å†å²è®°å½•æŸ¥çœ‹
- [ ] ä¸ªäººèµ„æ–™ç®¡ç†

### æ€§èƒ½æµ‹è¯•
- [ ] å¹¶å‘ç”¨æˆ·æµ‹è¯• (10ä¸ªç”¨æˆ·åŒæ—¶åœ¨çº¿)
- [ ] é•¿æ—¶é—´ä½¿ç”¨æµ‹è¯• (è¿ç»­ä½¿ç”¨2å°æ—¶)
- [ ] å¤§æ–‡ä»¶ä¸Šä¼ æµ‹è¯•
- [ ] ç½‘ç»œæ–­å¼€é‡è¿æµ‹è¯•

### å…¼å®¹æ€§æµ‹è¯•
- [ ] Chromeæµè§ˆå™¨
- [ ] Firefoxæµè§ˆå™¨
- [ ] Safariæµè§ˆå™¨
- [ ] ç§»åŠ¨ç«¯æµè§ˆå™¨

### å®‰å…¨æ€§æµ‹è¯•
- [ ] å¯†ç å¼ºåº¦éªŒè¯
- [ ] ä¼šè¯è¶…æ—¶æµ‹è¯•
- [ ] è¾“å…¥éªŒè¯æµ‹è¯•
- [ ] XSSé˜²æŠ¤æµ‹è¯•

## ğŸ› é—®é¢˜åé¦ˆ

### åé¦ˆæ–¹å¼
1. åœ¨çº¿åé¦ˆè¡¨å•
2. æµ‹è¯•ç¾¤èŠæŠ¥å‘Š
3. é‚®ä»¶åé¦ˆ: support@yyc3.com

### åé¦ˆå†…å®¹æ¨¡æ¿
```
é—®é¢˜æè¿°:
é‡ç°æ­¥éª¤:
é¢„æœŸç»“æœ:
å®é™…ç»“æœ:
ç¯å¢ƒä¿¡æ¯:
ä¸¥é‡ç¨‹åº¦: [ä½/ä¸­/é«˜/ç´§æ€¥]
```

## ğŸ“Š æµ‹è¯•æ•°æ®æ”¶é›†

ç³»ç»Ÿä¼šè‡ªåŠ¨æ”¶é›†:
- ç”¨æˆ·æ“ä½œæ—¥å¿—
- æ€§èƒ½æŒ‡æ ‡æ•°æ®
- é”™è¯¯æ—¥å¿—ä¿¡æ¯
- ä½¿ç”¨ç»Ÿè®¡æ•°æ®
```

---

## ğŸ”§ ç¬¬å…­é˜¶æ®µï¼šç›‘æ§ä¸ç»´æŠ¤

### 1. ç›‘æ§ç³»ç»Ÿæ­å»º

#### Prometheusé…ç½®
```yaml
# monitoring/prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  - "alert_rules.yml"

scrape_configs:
  - job_name: 'yyc3-backend'
    static_configs:
      - targets: ['backend:3001']
    metrics_path: '/metrics'

  - job_name: 'yyc3-frontend'
    static_configs:
      - targets: ['frontend:3000']
    metrics_path: '/metrics'

  - job_name: 'postgres'
    static_configs:
      - targets: ['postgres:5432']

  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']

alerting:
  alertmanagers:
    - static_configs:
      - targets:
        - alertmanager:9093
```

### 2. æ—¥å¿—ç®¡ç†ç³»ç»Ÿ

#### ELK Stacké…ç½®
```yaml
# logging/docker-compose.logging.yml
version: '3.8'

services:
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:7.15.0
    environment:
      - discovery.type=single-node
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    ports:
      - "9200:9200"
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data

  logstash:
    image: docker.elastic.co/logstash/logstash:7.15.0
    volumes:
      - ./logstash/pipeline:/usr/share/logstash/pipeline
      - ./logs:/var/log/app
    ports:
      - "5044:5044"
    depends_on:
      - elasticsearch

  kibana:
    image: docker.elastic.co/kibana/kibana:7.15.0
    ports:
      - "5601:5601"
    environment:
      ELASTICSEARCH_HOSTS: http://elasticsearch:9200
    depends_on:
      - elasticsearch

volumes:
  elasticsearch_data:
```

### 3. å¤‡ä»½ç­–ç•¥

#### è‡ªåŠ¨å¤‡ä»½è„šæœ¬ (`scripts/backup.sh`)
```bash
#!/bin/bash

BACKUP_DIR="/opt/backups/yyc3-ai"
DATE=$(date +%Y%m%d_%H%M%S)

echo "ğŸ”„ å¼€å§‹å¤‡ä»½..."

# æ•°æ®åº“å¤‡ä»½
docker exec yyc3-postgres pg_dump -U yyc3_admin yyc3_ai_prod > "$BACKUP_DIR/db_backup_$DATE.sql"

# æ–‡ä»¶å¤‡ä»½
tar -czf "$BACKUP_DIR/files_backup_$DATE.tar.gz" ./uploads

# é…ç½®å¤‡ä»½
cp -r ./configs "$BACKUP_DIR/configs_backup_$DATE"

echo "âœ… å¤‡ä»½å®Œæˆ: $BACKUP_DIR"

# æ¸…ç†æ—§å¤‡ä»½ (ä¿ç•™7å¤©)
find "$BACKUP_DIR" -name "*.sql" -mtime +7 -delete
find "$BACKUP_DIR" -name "*.tar.gz" -mtime +7 -delete
find "$BACKUP_DIR" -type d -name "configs_backup_*" -mtime +7 -exec rm -rf {} +
```

---

## ğŸ“š å®Œæ•´éƒ¨ç½²å‘½ä»¤æ€»ç»“

### æœ¬åœ°å¼€å‘
```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd yyc3-ai-call

# 2. å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.dev.yml up -d
npm run dev:backend
npm run dev:frontend
```

### ç”Ÿäº§éƒ¨ç½²
```bash
# 1. æ„å»ºé•œåƒ
docker build -t yyc3-ai/backend:latest ./backend
docker build -t yyc3-ai/frontend:latest ./frontend

# 2. éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒ
docker-compose -f docker-compose.prod.yml up -d

# 3. é…ç½®SSLå’ŒåŸŸå
./scripts/setup-ssl.sh
./scripts/configure-domain.sh
```

### æµ‹è¯•éƒ¨ç½²
```bash
# å¿«é€Ÿéƒ¨ç½²æµ‹è¯•ç¯å¢ƒ
./scripts/deploy-test.sh
```

### ç›‘æ§ç»´æŠ¤
```bash
# å¯åŠ¨ç›‘æ§ç³»ç»Ÿ
docker-compose -f docker-compose.monitoring.yml up -d

# æ‰§è¡Œå¤‡ä»½
./scripts/backup.sh

# æŸ¥çœ‹æ—¥å¿—
docker logs yyc3-backend -f
```

---

**éƒ¨ç½²æ—¶é—´**: 2025-11-12
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**ç»´æŠ¤å›¢é˜Ÿ**: YYC3å¼€å‘å›¢é˜Ÿ