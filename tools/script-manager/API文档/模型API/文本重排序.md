# 文本重排序

> `Rerank` 用于文本重排序，通过接收用户的查询文本及候选文本列表，使用模型计算候选文本与查询文本的相关性得分并返回分数。适用于智能问答、信息检索等场景。

## OpenAPI

````yaml openapi/openapi.json post /paas/v4/rerank
paths:
  path: /paas/v4/rerank
  method: post
  servers:
    - url: https://open.bigmodel.cn/api/
      description: 开放平台服务
  request:
    security:
      - title: bearerAuth
        parameters:
          query: {}
          header:
            Authorization:
              type: http
              scheme: bearer
              description: >-
                使用以下格式进行身份验证：Bearer [<your api
                key>](https://bigmodel.cn/usercenter/proj-mgmt/apikeys)
          cookie: {}
    parameters:
      path: {}
      query: {}
      header: {}
      cookie: {}
    body:
      application/json:
        schemaArray:
          - type: object
            properties:
              model:
                allOf:
                  - type: string
                    example: rerank
                    description: 要调用的模型编码，默认为`rerank`。
                    enum:
                      - rerank
              query:
                allOf:
                  - type: string
                    example: 查询候选文本A
                    description: 查询文本，用于与候选文本进行匹配`query`，最大长度为 `4096` 字符。
              top_n:
                allOf:
                  - type: integer
                    description: 返回得分最高的前 `n` 条结果，默认`0`返回所有。
              documents:
                allOf:
                  - type: array
                    items:
                      type: string
                    example:
                      - 需要打分的候选文本A
                      - 需要打分的候选文本B
                    description: 需要打分的候选文本数组,最多容纳 `128` 条。单条最大长度为 `4096` 字符。
              return_documents:
                allOf:
                  - type: boolean
                    description: 是否返回原始文本，默认值为`FALSE`。
              return_raw_scores:
                allOf:
                  - type: boolean
                    description: 是否返回原始分数。默认 `FALSE`。
              request_id:
                allOf:
                  - type: string
                    description: 由用户端传参，需保证唯一性,用户传空会默认生成
              user_id:
                allOf:
                  - type: string
                    description: 终端用户的唯一`ID`
            required: true
            refIdentifier: '#/components/schemas/RerankRequest'
            requiredProperties:
              - model
              - query
              - documents
        examples:
          文本重排序示例:
            value:
              model: rerank
              query: 查询候选文本A
              top_n: 4
              documents:
                - 需要打分的候选文本A
                - 需要打分的候选文本B
  response:
    '200':
      application/json:
        schemaArray:
          - type: object
            properties:
              created:
                allOf:
                  - type: integer
                    format: int64
                    example: 1732083164
              id:
                allOf:
                  - type: string
                    example: 20241120141244890ab4ee4af84acf
                    description: 智谱开放平台生成的任务序号，调用请求结果接口时请使用此序号
              request_id:
                allOf:
                  - type: string
                    example: '1111111111'
                    description: 用户在客户端请求时提交的任务编号或者平台生成的任务编号
              results:
                allOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/RerankResult'
              usage:
                allOf:
                  - $ref: '#/components/schemas/RerankUsage'
            refIdentifier: '#/components/schemas/RerankResponse'
            requiredProperties:
              - id
              - results
              - usage
        examples:
          example:
            value:
              created: 1732083164
              id: 20241120141244890ab4ee4af84acf
              request_id: '1111111111'
              results:
                - document: Washington, D.C. is the capital of the United States.
                  index: 1
                  relevance_score: 0.99866986
              usage:
                prompt_tokens: 72
                total_tokens: 72
        description: 业务处理成功
    default:
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                      message:
                        type: string
            refIdentifier: '#/components/schemas/Error'
        examples:
          example:
            value:
              error:
                code: <string>
                message: <string>
        description: 请求失败。
  deprecated: false
  type: path
components:
  schemas:
    RerankResult:
      type: object
      properties:
        document:
          type: string
          example: Washington, D.C. is the capital of the United States.
          description: 原文本
        index:
          type: integer
          example: 1
        relevance_score:
          type: number
          format: float
          example: 0.99866986
      required:
        - document
        - index
        - relevance_score
    RerankUsage:
      type: object
      properties:
        prompt_tokens:
          type: integer
          example: 72
        total_tokens:
          type: integer
          example: 72
      required:
        - prompt_tokens
        - total_tokens

````