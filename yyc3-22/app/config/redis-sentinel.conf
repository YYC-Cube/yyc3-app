# === Redis Sentinel配置文件 ===
# @description Redis Sentinel配置参数，用于实现Redis的高可用性
# @author YYC
# @version 1.0.0
# @created 2024-10-15

# -------------------- 基础配置 --------------------
# 绑定地址
bind 0.0.0.0

# 监听端口
port 26379

# 进程ID文件
pidfile /var/run/redis/sentinel.pid

# 日志文件
logfile /var/log/redis/sentinel.log

# 日志级别
loglevel notice

# 工作目录
dir /tmp

# -------------------- 监控配置 --------------------
# 监控的Redis主服务器
# 格式：sentinel monitor <master-name> <ip> <port> <quorum>
# master-name: 主服务器名称
# ip: 主服务器IP地址
# port: 主服务器端口
# quorum: 判定主服务器失效所需的Sentinel数量
sentinel monitor mymaster redis-master 6379 2

# 主服务器密码
# 格式：sentinel auth-pass <master-name> <password>
sentinel auth-pass mymaster password_yyc3

# 判定主服务器失效的超时时间（毫秒）
sentinel down-after-milliseconds mymaster 5000

# 故障转移时，同时从主服务器向从服务器复制的数量
sentinel parallel-syncs mymaster 1

# 故障转移超时时间（毫秒）
sentinel failover-timeout mymaster 60000

# -------------------- 安全配置 --------------------
# 客户端连接超时时间（毫秒）
timeout 30000

# TCP keepalive时间
tcp-keepalive 300

# -------------------- 高级配置 --------------------
# 启用哨兵日志
logfile /var/log/redis/sentinel.log

# 日志级别
loglevel notice

# 重定向客户端命令
# sentinel client-reconfig-script mymaster /etc/redis/sentinel-reconfig.sh

# 通知脚本
# sentinel notification-script mymaster /etc/redis/sentinel-notify.sh

# 检查脚本
# sentinel check-script mymaster /etc/redis/sentinel-check.sh

# 故障转移后脚本
# sentinel down-script mymaster /etc/redis/sentinel-down.sh
# sentinel failover-script mymaster /etc/redis/sentinel-failover.sh

# -------------------- 客户端配置 --------------------
# 最大客户端连接数
maxclients 10000

# -------------------- 集群配置 --------------------
# Sentinel集群名称
# sentinel cluster-name my-sentinel-cluster

# Sentinel集群间通信端口
# sentinel announce-port 26379

# Sentinel集群间通信IP
# sentinel announce-ip 192.168.1.100
