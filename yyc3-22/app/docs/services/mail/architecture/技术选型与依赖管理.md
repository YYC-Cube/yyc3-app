# ğŸš€ ğŸ“š YYCÂ³é‚®ä»¶å¹³å° - æŠ€æœ¯é€‰å‹ä¸ä¾èµ–ç®¡ç†æ–‡æ¡£

> **YYCÂ³ é¡¹ç›®æ–‡æ¡£**
> 
> @project YYCÂ³ Email Platform
> @type æŠ€æœ¯æ–‡æ¡£
> @version 1.0.0
> @created 2025-12-08
> @updated 2025-12-08
> @author YYCÂ³ <admin@0379.email>
> @url https://github.com/YYC-Cube/yyc3-app.git

## ğŸ¯ æŠ€æœ¯æ ˆæ¦‚è§ˆ

### å‰ç«¯æŠ€æœ¯æ ˆ
```json
{
  "framework": "Next.js 14.2.0",
  "language": "TypeScript 5.3.0",
  "styling": "Tailwind CSS 3.4.0",
  "ui_components": "React 18.2.0",
  "build_tool": "Webpack 5.88.0",
  "testing": "Jest 29.7.0 + React Testing Library"
}
```

### åç«¯æŠ€æœ¯æ ˆ
```json
{
  "runtime": "Node.js 18.17.0",
  "framework": "Express 4.18.2 / NestJS 10.0.0",
  "language": "TypeScript 5.3.0",
  "database": "PostgreSQL 15.3.0",
  "cache": "Redis 7.0.12",
  "queue": "Bull Queue 4.12.0",
  "validation": "Zod 3.22.0"
}
```

### DevOpså·¥å…·é“¾
```json
{
  "containerization": "Docker 24.0.0",
  "orchestration": "Docker Compose 2.18.0",
  "monitoring": "Prometheus + Grafana",
  "logging": "ELK Stack (Elasticsearch + Logstash + Kibana)",
  "ci_cd": "GitHub Actions / GitLab CI"
}
```

## ğŸ”§ æ ¸å¿ƒä¾èµ–è¯¦ç»†è¯´æ˜

### 1. å‰ç«¯ä¾èµ–é…ç½®

#### package.json (å‰ç«¯)
```json
{
  "name": "0379.email-platform-frontend",
  "version": "1.0.0",
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "test": "jest",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "next": "^14.2.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "typescript": "^5.3.0",
    "tailwindcss": "^3.4.0",
    "@types/node": "^20.0.0",
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "axios": "^1.6.0",
    "swr": "^2.2.0",
    "date-fns": "^2.30.0",
    "react-hook-form": "^7.47.0",
    "react-hot-toast": "^2.4.1",
    "lucide-react": "^0.292.0"
  },
  "devDependencies": {
    "eslint": "^8.52.0",
    "eslint-config-next": "^14.2.0",
    "prettier": "^3.0.0",
    "@testing-library/react": "^13.4.0",
    "@testing-library/jest-dom": "^6.1.0",
    "jest": "^29.7.0",
    "jest-environment-jsdom": "^29.7.0"
  }
}
```

### 2. åç«¯ä¾èµ–é…ç½®

#### package.json (åç«¯æœåŠ¡)
```json
{
  "name": "0379.email-platform-backend",
  "version": "1.0.0",
  "scripts": {
    "start": "node dist/index.js",
    "dev": "ts-node-dev --respawn --transpile-only src/index.ts",
    "build": "tsc",
    "test": "jest",
    "migrate": "node dist/scripts/migrate.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "typescript": "^5.3.0",
    "@types/express": "^4.17.0",
    "@types/node": "^20.0.0",
    "pg": "^8.11.0",
    "redis": "^4.6.0",
    "bull": "^4.12.0",
    "nodemailer": "^6.9.0",
    "mailgun-js": "^0.22.0",
    "jsonwebtoken": "^9.0.0",
    "bcryptjs": "^2.4.3",
    "zod": "^3.22.0",
    "helmet": "^7.0.0",
    "cors": "^2.8.5",
    "express-rate-limit": "^6.10.0",
    "winston": "^3.11.0",
    "joi": "^17.11.0",
    "multer": "^1.4.5"
  },
  "devDependencies": {
    "@types/pg": "^8.10.0",
    "@types/jsonwebtoken": "^9.0.0",
    "@types/bcryptjs": "^2.4.0",
    "@types/nodemailer": "^6.4.0",
    "@types/multer": "^1.4.0",
    "ts-node-dev": "^2.0.0",
    "jest": "^29.7.0",
    "@types/jest": "^29.5.0",
    "supertest": "^6.3.0",
    "@types/supertest": "^2.0.0"
  }
}
```

## ğŸ“¦ ä¾èµ–ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

### 1. è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
```json
{
  "versioning_strategy": "Semantic Versioning (SemVer)",
  "version_format": "MAJOR.MINOR.PATCH",
  "rules": {
    "major": "ä¸å…¼å®¹çš„APIå˜æ›´",
    "minor": "å‘åå…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢",
    "patch": "å‘åå…¼å®¹çš„é—®é¢˜ä¿®æ­£"
  }
}
```

### 2. ä¾èµ–å®‰å…¨ç­–ç•¥

#### package.json å®‰å…¨é…ç½®
```json
{
  "scripts": {
    "security:audit": "npm audit --audit-level=moderate",
    "security:fix": "npm audit fix",
    "security:update": "npm update && npm audit fix"
  },
  "engines": {
    "node": ">=18.17.0",
    "npm": ">=9.0.0"
  },
  "browserslist": [
    "> 1%",
    "last 2 versions",
    "not dead"
  ]
}
```

### 3. é”å®šæ–‡ä»¶ç®¡ç†

#### .npmrc é…ç½®
```ini
# ä¾èµ–é”å®š
package-lock=true
shrinkwrap=false

# å®‰å…¨è®¾ç½®
audit-level=moderate
fund=false

# æ€§èƒ½ä¼˜åŒ–
cache=/tmp/.npm
registry=https://registry.npmjs.org/
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„ä¸æ¨¡å—åŒ–

### 1. Monorepo ç»“æ„è®¾è®¡
```
0379.email-platform/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ admin/              # ç®¡ç†é¢æ¿å‰ç«¯
â”‚   â”œâ”€â”€ web/               # å®˜ç½‘å‰ç«¯
â”‚   â”œâ”€â”€ api/               # APIç½‘å…³æœåŠ¡
â”‚   â”œâ”€â”€ mail-service/      # é‚®ä»¶æœåŠ¡
â”‚   â”œâ”€â”€ llm-service/       # AIæ™ºèƒ½æœåŠ¡
â”‚   â””â”€â”€ analytics/         # æ•°æ®åˆ†ææœåŠ¡
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared/            # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ ui-components/     # é€šç”¨UIç»„ä»¶
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°åº“
â”‚   â””â”€â”€ config/            # é…ç½®æ–‡ä»¶
â””â”€â”€ tools/
    â”œâ”€â”€ scripts/           # æ„å»ºè„šæœ¬
    â””â”€â”€ docker/            # Dockeré…ç½®
```

### 2. å…±äº«åŒ…è®¾è®¡

#### packages/shared/package.json
```json
{
  "name": "@0379/shared",
  "version": "1.0.0",
  "main": "dist/index.js",
  "types": "dist/index.d.ts",
  "dependencies": {
    "zod": "^3.22.0",
    "date-fns": "^2.30.0"
  }
}
```

#### packages/shared/src/types/index.ts
```typescript
// æ ¸å¿ƒç±»å‹å®šä¹‰
export interface User {
  id: string;
  username: string;
  email: string;
  role: UserRole;
  status: UserStatus;
  createdAt: Date;
  updatedAt: Date;
}

export interface Email {
  id: string;
  senderId: string;
  recipientEmail: string;
  subject: string;
  body: string;
  isHtml: boolean;
  status: EmailStatus;
  sentAt?: Date;
  attachments?: Attachment[];
}

export type UserRole = 'admin' | 'user' | 'guest';
export type UserStatus = 'active' | 'inactive' | 'suspended';
export type EmailStatus = 'pending' | 'sent' | 'delivered' | 'failed' | 'bounced';
```

## ğŸ”„ CI/CD æµæ°´çº¿é…ç½®

### 1. GitHub Actions é…ç½®

#### .github/workflows/ci.yml
```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [18.x, 20.x]
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v4
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run linting
      run: npm run lint
    
    - name: Run type checking
      run: npm run type-check
    
    - name: Run tests
      run: npm test
    
    - name: Build applications
      run: npm run build

  security:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Run security audit
      run: npm audit --audit-level=moderate
    
    - name: Check for vulnerabilities
      run: npx snyk test

  deploy:
    needs: [test, security]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Deploy to production
      run: |
        # éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
        echo "Deploying to production..."
```

### 2. Docker å¤šé˜¶æ®µæ„å»º

#### Dockerfile (å¤šæœåŠ¡æ„å»º)
```dockerfile
# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder
WORKDIR /app

# å¤åˆ¶åŒ…ç®¡ç†æ–‡ä»¶
COPY package*.json ./
COPY apps/*/package*.json ./apps/*/

# å®‰è£…ä¾èµ–
RUN npm ci --only=production --workspaces

# å¤åˆ¶æºç å¹¶æ„å»º
COPY . .
RUN npm run build

# è¿è¡Œé˜¶æ®µ
FROM node:18-alpine AS runtime
WORKDIR /app

# åˆ›å»ºérootç”¨æˆ·
RUN addgroup -g 1001 -S nodejs && \
    adduser -S nextjs -u 1001

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=builder --chown=nextjs:nodejs /app/dist ./dist
COPY --from=builder --chown=nextjs:nodejs /app/node_modules ./node_modules

# æš´éœ²ç«¯å£
EXPOSE 3000

USER nextjs
CMD ["npm", "start"]
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ„å»ºä¼˜åŒ–

#### next.config.js é…ç½®
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  // ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–
  productionBrowserSourceMaps: false,
  compress: true,
  
  // å›¾ç‰‡ä¼˜åŒ–
  images: {
    domains: ['0379.email'],
    formats: ['image/webp', 'image/avif'],
    deviceSizes: [640, 750, 828, 1080, 1200],
  },
  
  // Webpackä¼˜åŒ–
  webpack: (config, { buildId, dev, isServer, defaultLoaders, webpack }) => {
    // ä»£ç åˆ†å‰²ä¼˜åŒ–
    config.optimization = {
      ...config.optimization,
      splitChunks: {
        chunks: 'all',
        cacheGroups: {
          vendor: {
            test: /[\\/]node_modules[\\/]/,
            name: 'vendors',
            chunks: 'all',
          },
        },
      },
    };
    
    return config;
  },
  
  // ç¯å¢ƒå˜é‡
  env: {
    CUSTOM_KEY: process.env.CUSTOM_KEY,
  },
  
  // å¤´éƒ¨è®¾ç½®
  async headers() {
    return [
      {
        source: '/(.*)',
        headers: [
          {
            key: 'X-Frame-Options',
            value: 'DENY',
          },
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff',
          },
        ],
      },
    ];
  },
};

module.exports = nextConfig;
```

### 2. è¿è¡Œæ—¶ä¼˜åŒ–

#### ä¾èµ–æ‡’åŠ è½½
```typescript
// åŠ¨æ€å¯¼å…¥ç»„ä»¶
const MailCompose = dynamic(() => import('@/components/MailCompose'), {
  loading: () => <LoadingSpinner />,
  ssr: false
});

// è·¯ç”±çº§åˆ«ä»£ç åˆ†å‰²
const AdminPanel = dynamic(() => import('@/pages/admin'), {
  loading: () => <AdminSkeleton />
});
```

## ğŸ”§ å¼€å‘å·¥å…·é…ç½®

### 1. ESLint é…ç½®

#### .eslintrc.json
```json
{
  "extends": [
    "next/core-web-vitals",
    "@typescript-eslint/recommended",
    "prettier"
  ],
  "parser": "@typescript-eslint/parser",
  "plugins": ["@typescript-eslint"],
  "rules": {
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/no-explicit-any": "warn",
    "prefer-const": "error",
    "no-console": "warn"
  },
  "ignorePatterns": ["dist/", "node_modules/", ".next/"]
}
```

### 2. Prettier é…ç½®

#### .prettierrc
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "bracketSpacing": true,
  "arrowParens": "avoid"
}
```

### 3. TypeScript é…ç½®

#### tsconfig.json
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
      "@/components/*": ["./src/components/*"],
      "@/lib/*": ["./src/lib/*"],
      "@/types/*": ["./src/types/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules"]
}
```

## ğŸ“ ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ

### 1. ä¾èµ–æ›´æ–°ç­–ç•¥
- **å®šæœŸå®¡æŸ¥**: æ¯æœˆå®¡æŸ¥ä¸€æ¬¡ä¾èµ–æ›´æ–°
- **å®‰å…¨è¡¥ä¸**: ç«‹å³æ›´æ–°å®‰å…¨ç›¸å…³ä¾èµ–
- **åŠŸèƒ½æ›´æ–°**: å­£åº¦æ›´æ–°ä¸»è¦æ¡†æ¶ç‰ˆæœ¬
- **å…¼å®¹æ€§æµ‹è¯•**: é‡å¤§æ›´æ–°å‰è¿›è¡Œå……åˆ†æµ‹è¯•

### 2. åŒ…ç®¡ç†å·¥å…·é€‰æ‹©
- **npm**: å®˜æ–¹åŒ…ç®¡ç†ï¼Œé»˜è®¤é€‰æ‹©
- **pnpm**: ç£ç›˜ç©ºé—´ä¼˜åŒ–ï¼Œå¯é€‰æ›¿ä»£
- **yarn**: ç¨³å®šæ€§å¥½ï¼Œå¯é€‰æ›¿ä»£

### 3. ä¾èµ–å®‰å…¨æ€§
```bash
# å®šæœŸå®‰å…¨æ£€æŸ¥è„šæœ¬
#!/bin/bash
set -euo pipefail

echo "ğŸ” æ­£åœ¨æ£€æŸ¥ä¾èµ–å®‰å…¨æ€§..."

# è¿è¡Œå®‰å…¨å®¡è®¡
npm audit

# æ£€æŸ¥å·²çŸ¥æ¼æ´
npx snyk test

# æ£€æŸ¥è¿‡æœŸä¾èµ–
npm outdated

echo "âœ… å®‰å…¨æ£€æŸ¥å®Œæˆ"
```

---

## ğŸ“‹ æ€»ç»“

æŠ€æœ¯é€‰å‹å’Œä¾èµ–ç®¡ç†æ˜¯é¡¹ç›®æˆåŠŸçš„åŸºç¡€ã€‚é€šè¿‡åˆç†çš„æŠ€æœ¯æ ˆé€‰æ‹©ã€ä¸¥æ ¼çš„ç‰ˆæœ¬æ§åˆ¶å’Œå…¨é¢çš„å®‰å…¨ç­–ç•¥ï¼Œç¡®ä¿é¡¹ç›®çš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

**æŠ€æœ¯ä¼˜åŠ¿**:
- âœ… ç°ä»£åŒ–æŠ€æœ¯æ ˆï¼Œç”Ÿæ€å®Œå–„
- âœ… TypeScriptä¸¥æ ¼ç±»å‹æ£€æŸ¥
- âœ… æ¨¡å—åŒ–æ¶æ„è®¾è®¡
- âœ… å®Œæ•´çš„CI/CDæµç¨‹

**æŒç»­æ”¹è¿›**:
- ğŸ”„ å®šæœŸä¾èµ–æ›´æ–°å’Œå®‰å…¨å®¡æŸ¥
- ğŸ”„ æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–
- ğŸ”„ å¼€å‘æµç¨‹æ ‡å‡†åŒ–

ä¿æŒä»£ç å¥åº·ï¼Œç¨³æ­¥å‰è¡Œï¼ ğŸŒ¹