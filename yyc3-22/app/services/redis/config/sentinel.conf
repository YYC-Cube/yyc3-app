/**
 * @file Redis哨兵配置文件
 * @description 用于监控Redis主从集群并实现自动故障转移
 * @version 1.0.0
 * @created 2024-01-15
 */

# 哨兵实例端口
port 26379

# 哨兵实例名称
protected-mode no

# 日志文件位置
logfile "/var/log/redis/sentinel.log"

# 工作目录
dir /tmp

# 监控的主节点配置
# sentinel monitor <master-name> <ip> <port> <quorum>
# master-name: 主节点名称
# ip: 主节点IP
# port: 主节点端口
# quorum: 故障转移所需的最小哨兵数量

# 监控yyc3主节点，至少需要2个哨兵同意才能进行故障转移
sentinel monitor yyc3 redis-master 6379 2

# 主节点密码
sentinel auth-pass yyc3 redis_yyc3

# 主节点响应超时时间（毫秒）
sentinel down-after-milliseconds yyc3 5000

# 故障转移超时时间（毫秒）
sentinel failover-timeout yyc3 180000

# 故障转移时，最多可以有多少个从节点同时对新的主节点进行同步
sentinel parallel-syncs yyc3 1

# 哨兵通知脚本（可选，用于故障转移时发送通知）
# sentinel notification-script yyc3 /path/to/notification.sh

# 客户端重新配置脚本（可选，用于故障转移后通知客户端）
# sentinel client-reconfig-script yyc3 /path/to/reconfig.sh

# 配置文件自动保存
# 当哨兵检测到配置变更时，会自动保存到这个文件
sentinel config-epoch yyc3 0

# 保存哨兵的当前状态
sentinel leader-epoch yyc3 0

# 禁用Sentinel的保护模式
protected-mode no

# 开启后台运行
daemonize no

# 绑定地址（容器环境中使用0.0.0.0）
bind 0.0.0.0

# 最大客户端连接数
maxclients 10000

# 设置TCP keepalive
# 这个参数设置了TCP连接的keepalive时间，单位是秒
# 如果设置为0，则禁用TCP keepalive
tcp-keepalive 300