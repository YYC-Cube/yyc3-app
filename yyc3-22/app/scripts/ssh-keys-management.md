# SSHå¯†é’¥ç®¡ç†æŒ‡å—

## ğŸš€ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†é¡¹ç›®ä¸­SSHå¯†é’¥çš„ç®¡ç†å·¥å…·å’Œä½¿ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬å¯†é’¥ç”Ÿæˆã€åŒæ­¥å’Œç¯å¢ƒè®¾ç½®çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

## ğŸ“ æ ¸å¿ƒè„šæœ¬æ–‡ä»¶

### 1. setup-ssh-env.sh - ä¸»å¯åŠ¨è„šæœ¬

**åŠŸèƒ½**: æ•´åˆå¯†é’¥ç”Ÿæˆå’ŒåŒæ­¥åŠŸèƒ½ï¼Œæä¾›ä¸€é”®å¼SSHç¯å¢ƒè®¾ç½®

```bash
# æ‰§è¡Œå®Œæ•´è®¾ç½®ï¼ˆå¤‡ä»½é…ç½®ã€å¤åˆ¶é…ç½®ã€ç”Ÿæˆå¯†é’¥ã€åŒæ­¥å¯†é’¥ï¼‰
./setup-ssh-env.sh --full

# ä»…ç”Ÿæˆå¯†é’¥
./setup-ssh-env.sh --generate

# ä»…åŒæ­¥å¯†é’¥
./setup-ssh-env.sh --sync

# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
./setup-ssh-env.sh --help
```

### 2. generate-ssh-keys.sh - å¯†é’¥ç”Ÿæˆè„šæœ¬

**åŠŸèƒ½**: æ ¹æ®é…ç½®ç”Ÿæˆ7ç§ä¸“ç”¨SSHå¯†é’¥ï¼Œæ”¯æŒed25519/RSAä¸¤ç§ç±»å‹

```bash
# ç”Ÿæˆé»˜è®¤ed25519ç±»å‹å¯†é’¥
./generate-ssh-keys.sh

# ç”ŸæˆRSAç±»å‹å¯†é’¥
./generate-ssh-keys.sh --type rsa

# æ˜¾ç¤ºå·²ç”Ÿæˆçš„å¯†é’¥ä¿¡æ¯
./generate-ssh-keys.sh --display
```

### 3. sync-ssh-keys.sh - å¯†é’¥åŒæ­¥è„šæœ¬

**åŠŸèƒ½**: å°†é»˜è®¤å¯†é’¥åŒæ­¥è‡³é…ç½®ä¸­æŒ‡å®šçš„è·¯å¾„ï¼Œæ”¯æŒå¤åˆ¶å’Œé“¾æ¥ä¸¤ç§æ¨¡å¼

```bash
# ä½¿ç”¨å¤åˆ¶æ¨¡å¼åŒæ­¥å¯†é’¥
./sync-ssh-keys.sh

# ä½¿ç”¨é“¾æ¥æ¨¡å¼åŒæ­¥å¯†é’¥
./sync-ssh-keys.sh --mode link
```

## ğŸ”‘ å¯†é’¥ç±»å‹è¯´æ˜

ç³»ç»Ÿä¼šç”Ÿæˆä»¥ä¸‹7ç§ä¸“ç”¨å¯†é’¥ï¼š

1. **id_rsa_local** - æœ¬åœ°å±€åŸŸç½‘è®¾å¤‡å¯†é’¥
2. **id_rsa_aliyun** - é˜¿é‡Œäº‘æœåŠ¡å™¨å¯†é’¥
3. **id_rsa_dev** - å¼€å‘ç¯å¢ƒæœåŠ¡å™¨å¯†é’¥
4. **id_rsa_prod** - ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨å¯†é’¥
5. **id_rsa_github_cube** - GitHubä¸»ä»“(YYC-Cube)å¯†é’¥
6. **id_rsa_github_neuxs** - GitHubå‰¯ä»“(YY-Neuxs)å¯†é’¥
7. **id_rsa_docker** - Dockerè¿œç¨‹è®¿é—®å¯†é’¥

## ğŸ“‹ ä½¿ç”¨æµç¨‹

### 1. é¦–æ¬¡è®¾ç½®

```bash
cd /Users/yanyu/www/app/scripts
chmod +x *.sh
./setup-ssh-env.sh --full
```

### 2. è¿æ¥æœåŠ¡å™¨ç¤ºä¾‹

```bash
# è¿æ¥æœ¬åœ°MacBook
ssh yyc3-22

# è¿æ¥é˜¿é‡Œäº‘æœåŠ¡å™¨
ssh yyc3-121
```

### 3. æ·»åŠ å…¬é’¥åˆ°æœåŠ¡å™¨

```bash
# ä½¿ç”¨ssh-copy-id
ssh-copy-id -i ~/.ssh/id_rsa_local.pub user@server

# æˆ–æ‰‹åŠ¨å¤åˆ¶å…¬é’¥å†…å®¹
cat ~/.ssh/id_rsa_aliyun.pub
# å°†è¾“å‡ºå†…å®¹æ·»åŠ åˆ°æœåŠ¡å™¨çš„ ~/.ssh/authorized_keys æ–‡ä»¶
```

## ğŸ”„ åŒæ­¥æ¨¡å¼è¯´æ˜

- **copyæ¨¡å¼**ï¼ˆé»˜è®¤ï¼‰: å¤åˆ¶å¯†é’¥æ–‡ä»¶ï¼Œä¿®æ”¹ä¸å½±å“åŸæ–‡ä»¶
- **linkæ¨¡å¼**: åˆ›å»ºç¬¦å·é“¾æ¥ï¼ŒèŠ‚çœç©ºé—´ä½†ä¿®æ”¹ä¼šç›¸äº’å½±å“

## âš ï¸ æ³¨æ„äº‹é¡¹

1. è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„ç§é’¥æ–‡ä»¶ï¼Œä¸è¦æ³„éœ²ç»™ä»–äºº
2. ç§é’¥æ–‡ä»¶æƒé™å¿…é¡»è®¾ç½®ä¸º600ï¼Œå…¬é’¥æ–‡ä»¶æƒé™ä¸º644
3. å»ºè®®ä½¿ç”¨ed25519ç±»å‹å¯†é’¥ï¼Œæ›´å®‰å…¨ä¸”æ€§èƒ½æ›´å¥½
4. å®šæœŸå¤‡ä»½æ‚¨çš„SSHå¯†é’¥

## ğŸ› ï¸ æ•…éšœæ’é™¤

### æƒé™é—®é¢˜

```bash
chmod 700 ~/.ssh
chmod 600 ~/.ssh/config
chmod 600 ~/.ssh/id_rsa_*
chmod 644 ~/.ssh/id_rsa_*.pub
```

### è¿æ¥é—®é¢˜

```bash
# æµ‹è¯•SSHè¿æ¥
ssh -v user@server

# æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®
cat ~/.ssh/config
```

## ğŸ“ æ›´æ–°è¯´æ˜

- å·²ç§»é™¤é‡å¤çš„æ“ä½œç³»ç»Ÿç‰¹å®šè„šæœ¬ï¼ˆgenerate-keys-linux.shã€generate-keys-macos.shã€setup-ssh-keys.shï¼‰
- ä¿ç•™å¹¶ä¼˜åŒ–äº†æ ¸å¿ƒåŠŸèƒ½è„šæœ¬ï¼Œç¡®ä¿è·¨å¹³å°å…¼å®¹æ€§
- æä¾›äº†æ›´ç®€æ´çš„ä½¿ç”¨æ–¹æ³•å’Œå®Œæ•´çš„æ–‡æ¡£è¯´æ˜

ä¿æŒä»£ç å¥åº·ï¼Œç¨³æ­¥å‰è¡Œï¼ ğŸŒ¹
