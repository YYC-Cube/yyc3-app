# ===== YYC³ NAS 数据库统一配置 =====
# NAS服务器: 192.168.3.45 (铁威马 F4-423)
# 最后更新: 2025-12-06

# ===== NAS服务器信息 =====
NAS_HOST=192.168.3.45
NAS_PORT=57
NAS_NAME=YanYuCloud
NAS_USER=YYC
NAS_ROOT=/YYC

# ===== PostgreSQL 主数据库配置 =====
POSTGRES_HOST=192.168.3.45
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=yyc3_db_master_2025
POSTGRES_DB=yyc3_main

# 数据库连接配置
POSTGRES_MAX_CONNECTIONS=200
POSTGRES_MIN_CONNECTIONS=10
POSTGRES_CONNECTION_TIMEOUT=30
POSTGRES_IDLE_TIMEOUT=600
POSTGRES_POOL_SIZE=20

# ===== PostgreSQL 专用数据库配置 =====
# 0379.email 域名数据库
POSTGRES_EMAIL_DB=0379_email
POSTGRES_EMAIL_USER=email_user
POSTGRES_EMAIL_PASSWORD=email_db_2025

# 0379.world 域名数据库
POSTGRES_WORLD_DB=0379_world
POSTGRES_WORLD_USER=world_user
POSTGRES_WORLD_PASSWORD=world_db_2025

# 行业应用数据库
POSTGRES_WEDDING_DB=0379_wedding
POSTGRES_HOTEL_DB=0379_hotel
POSTGRES_EDUCATION_DB=0379_education
POSTGRES_MEDICAL_DB=0379_medical
POSTGRES_FINANCE_DB=0379_finance
POSTGRES_REAL_ESTATE_DB=0379_realestate
POSTGRES_RESTAURANT_DB=0379_restaurant

# 企业服务数据库
POSTGRES_CRM_DB=0379_crm
POSTGRES_ERP_DB=0379_erp
POSTGRES_HR_DB=0379_hr
POSTGRES_OA_DB=0379_oa
POSTGRES_PROJECT_DB=0379_project

# 技术服务数据库
POSTGRES_CLOUD_DB=0379_cloud
POSTGRES_AI_DB=0379_ai
POSTGRES_IOT_DB=0379_iot
POSTGRES_BIGDATA_DB=0379_bigdata
POSTGRES_BLOCKCHAIN_DB=0379_blockchain

# ===== Redis 配置 =====
REDIS_HOST=192.168.3.45
REDIS_PORT=6379
REDIS_PASSWORD=yyc3_redis_master_2025
REDIS_DB=0

# Redis 连接配置
REDIS_MAX_CONNECTIONS=100
REDIS_MIN_CONNECTIONS=5
REDIS_CONNECTION_TIMEOUT=10
REDIS_COMMAND_TIMEOUT=5
REDIS_POOL_SIZE=10

# Redis 数据库分离
REDIS_CACHE_DB=0
REDIS_SESSION_DB=1
REDIS_QUEUE_DB=2
REDIS_WEBSOCKET_DB=3
REDIS_ANALYTICS_DB=4
REDIS_RATELIMIT_DB=5

# ===== 数据存储路径配置 =====
# NAS存储路径
NAS_STORAGE_ROOT=/YYC
NAS_DATA_ROOT=${NAS_STORAGE_ROOT}/data
NAS_DB_ROOT=${NAS_STORAGE_ROOT}/database
NAS_BACKUP_ROOT=${NAS_STORAGE_ROOT}/backup
NAS_LOG_ROOT=${NAS_STORAGE_ROOT}/logs

# PostgreSQL 数据路径
POSTGRES_DATA_PATH=${NAS_DB_ROOT}/postgresql/data
POSTGRES_BACKUP_PATH=${NAS_BACKUP_ROOT}/postgresql
POSTGRES_LOG_PATH=${NAS_LOG_ROOT}/postgresql
POSTGRES_CONFIG_PATH=${NAS_DB_ROOT}/postgresql/config

# Redis 数据路径
REDIS_DATA_PATH=${NAS_DB_ROOT}/redis/data
REDIS_BACKUP_PATH=${NAS_BACKUP_ROOT}/redis
REDIS_LOG_PATH=${NAS_LOG_ROOT}/redis
REDIS_CONFIG_PATH=${NAS_DB_ROOT}/redis/config

# ===== 备份配置 =====
# 自动备份
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=true
BACKUP_ENCRYPTION=true

# 增量备份
INCREMENTAL_BACKUP_ENABLED=true
INCREMENTAL_BACKUP_SCHEDULE="0 */6 * * *"
INCREMENTAL_BACKUP_RETENTION=7

# 全量备份
FULL_BACKUP_SCHEDULE="0 2 * * 0"
FULL_BACKUP_RETENTION=4

# 备份验证
BACKUP_VERIFICATION_ENABLED=true
BACKUP_VERIFICATION_SCHEDULE="0 3 * * *"

# ===== 监控配置 =====
# 性能监控
MONITORING_ENABLED=true
METRICS_COLLECTION_INTERVAL=60
SLOW_QUERY_THRESHOLD=1000
CONNECTION_THRESHOLD=150

# 健康检查
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# 告警配置
ALERT_EMAIL=contact@0379.email
ALERT_CPU_THRESHOLD=80
ALERT_MEMORY_THRESHOLD=85
ALERT_DISK_THRESHOLD=90
ALERT_CONNECTION_THRESHOLD=180

# ===== 日志配置 =====
# 日志级别
LOG_LEVEL=info
LOG_FORMAT=json
LOG_ROTATION=true
LOG_MAX_SIZE=100M
LOG_MAX_FILES=10

# 慢查询日志
SLOW_QUERY_LOG=true
SLOW_QUERY_FILE=${NAS_LOG_ROOT}/postgresql/slow_queries.log
SLOW_QUERY_MIN_DURATION=1000

# 连接日志
CONNECTION_LOG=true
CONNECTION_LOG_FILE=${NAS_LOG_ROOT}/postgresql/connections.log

# ===== 安全配置 =====
# SSL配置
SSL_ENABLED=true
SSL_CERT_FILE=${NAS_DB_ROOT}/ssl/server.crt
SSL_KEY_FILE=${NAS_DB_ROOT}/ssl/server.key
SSL_CA_FILE=${NAS_DB_ROOT}/ssl/ca.crt

# 访问控制
ACCESS_CONTROL_ENABLED=true
ALLOWED_IPS=192.168.3.0/24,8.152.195.33,8.130.127.121
DENY_IPS=0.0.0.0/0

# 审计配置
AUDIT_ENABLED=true
AUDIT_LOG_FILE=${NAS_LOG_ROOT}/postgresql/audit.log
AUDIT_LEVEL=all

# ===== 性能优化配置 =====
# PostgreSQL 性能
SHARED_BUFFERS=2GB
EFFECTIVE_CACHE_SIZE=6GB
MAINTENANCE_WORK_MEM=512MB
CHECKPOINT_COMPLETION_TARGET=0.9
WAL_BUFFERS=16MB
DEFAULT_STATISTICS_TARGET=100

# 连接池配置
POOL_MAX_SIZE=50
POOL_MIN_SIZE=5
POOL_IDLE_TIMEOUT=300
POOL_VALIDATION_INTERVAL=30000

# ===== 高可用配置 =====
# 主从复制
REPLICATION_ENABLED=false
MASTER_HOST=192.168.3.45
SLAVE_HOSTS=
REPLICATION_USER=replicator
REPLICATION_PASSWORD=repl_password_2025

# 故障转移
FAILOVER_ENABLED=false
FAILOVER_TIMEOUT=30
FAILOVER_RETRIES=3

# ===== 维护配置 =====
# 定期维护
MAINTENANCE_ENABLED=true
MAINTENANCE_SCHEDULE="0 3 * * 0"
MAINTENANCE_WINDOW=3600

# 数据清理
DATA_CLEANUP_ENABLED=true
DATA_CLEANUP_SCHEDULE="0 4 * * *"
DATA_RETENTION_DAYS=90

# 索引优化
INDEX_OPTIMIZATION_ENABLED=true
INDEX_OPTIMIZATION_SCHEDULE="0 5 * * 0"

# ===== 开发连接配置 =====
# 本地开发连接
DEV_DB_HOST=192.168.3.45
DEV_DB_PORT=5432
DEV_DB_USER=dev_user
DEV_DB_PASSWORD=dev_db_2025
DEV_DB_NAME=yyc3_dev

# 测试数据库
TEST_DB_HOST=192.168.3.45
TEST_DB_PORT=5432
TEST_DB_USER=test_user
TEST_DB_PASSWORD=test_db_2025
TEST_DB_NAME=yyc3_test

# ===== 导入导出配置 =====
# 数据导出
EXPORT_PATH=${NAS_BACKUP_ROOT}/exports
EXPORT_FORMAT=sql,csv,json
EXPORT_COMPRESSION=true

# 数据导入
IMPORT_PATH=${NAS_BACKUP_ROOT}/imports
IMPORT_FORMAT=sql,csv,json
IMPORT_VALIDATION=true

# ===== 工具配置 =====
# pgAdmin 配置
PGADMIN_PORT=5050
PGADMIN_USER=admin@0379.email
PGADMIN_PASSWORD=pgadmin_2025

# Redis Commander 配置
REDIS_COMMANDER_PORT=8081
REDIS_COMMANDER_USER=admin
REDIS_COMMANDER_PASSWORD=admin_2025