# 智能体对话

> 与智能体进行对话交互。支持同步和流式调用，提供智能体的专业能力。见 [智能体文档](/cn/guide/agents/translation)

## OpenAPI

````yaml openapi/openapi.json post /v1/agents
paths:
  path: /v1/agents
  method: post
  servers:
    - url: https://open.bigmodel.cn/api/
      description: 开放平台服务
  request:
    security:
      - title: bearerAuth
        parameters:
          query: {}
          header:
            Authorization:
              type: http
              scheme: bearer
              description: >-
                使用以下格式进行身份验证：Bearer [<your api
                key>](https://bigmodel.cn/usercenter/proj-mgmt/apikeys)
          cookie: {}
    parameters:
      path: {}
      query: {}
      header: {}
      cookie: {}
    body:
      application/json:
        schemaArray:
          - type: object
            properties:
              agent_id:
                allOf:
                  - oneOf:
                      - type: string
                        enum:
                          - general_translation
                          - slides_glm_agent
                          - cartoon_generator_agent
                          - ai_drawing_agent
                          - receipt_recognition_agent
                          - clothes_recognition_agent
                          - contract_parser_agent
                          - service_check_agent
                          - subtitle_translation_agent
                          - intelligent_education_correction_agent
                          - job_matching_agent
                          - social_translation_agent
                          - social_literature_translation_agent
                          - intelligent_education_solve_agent
                          - vidu_template_agent
                          - bidwin_parser_agent
                        description: >-
                          此处提供 通用翻译智能体 `general_translation`
                          的拓展参数模板作为示例，其他内嵌智能体需要参考文档在下方手动设置拓展参数。
                    description: 智能体 ID
              stream:
                allOf:
                  - type: boolean
                    description: 是否选择流式输出。当一个 `agent` 提供流式与非流式两种输出方式时，可根据需求选择一种。
                    default: false
              messages:
                allOf:
                  - type: array
                    description: 会话消息体列表。
                    items:
                      type: object
                      required:
                        - role
                        - content
                      properties:
                        role:
                          type: string
                          description: 消息作者的角色。用户输入时 `role = user`。
                          enum:
                            - system
                            - user
                            - assistant
                          example: user
                        content:
                          oneOf:
                            - type: string
                              description: 用户输入的文本内容。
                              example: 请帮我翻译这段文字：Hello World
                            - type: object
                              description: 单个多模态内容，用于只有一个元素的情况
                              properties:
                                type:
                                  type: string
                                  description: 内容类型，可以是文本、文件`ID`、文件链接或图片链接
                                  enum:
                                    - text
                                    - file_id
                                    - file_url
                                    - image_url
                                text:
                                  type: string
                                  description: 当 `type` 为 `text` 时的文本内容
                                  example: 请帮我翻译这段文字：Hello World
                                file_id:
                                  type: string
                                  description: 当 `type` 为 `file_id` 时的文件唯一标识
                                  example: >-
                                    agent-1750681215-9b92722d788f4b32bab28cc333293584
                                file_url:
                                  type: string
                                  description: 当 `type` 为 `file_url` 时的文件链接
                                  example: https://example.com/my_oss/document.pdf
                                image_url:
                                  type: string
                                  description: 当 `type` 为 `image_url` 时的图片链接
                                  example: https://example.com/my_oss/image.png
                              required:
                                - type
                            - type: array
                              description: 多模态内容数组，支持文本、文件和图片
                              items:
                                type: object
                                properties:
                                  type:
                                    type: string
                                    description: 内容类型，可以是文本、文件`ID`、文件链接或图片链接
                                    enum:
                                      - text
                                      - file_id
                                      - file_url
                                      - image_url
                                  text:
                                    type: string
                                    description: 当 `type` 为 `text` 时的文本内容
                                    example: 请帮我翻译这段文字：Hello World
                                  file_id:
                                    type: string
                                    description: 当 `type` 为 `file_id` 时的文件唯一标识
                                    example: >-
                                      agent-1750681215-9b92722d788f4b32bab28cc333293584
                                  file_url:
                                    type: string
                                    description: 当 `type` 为 `file_url` 时的文件链接
                                    example: https://example.com/my_oss/document.pdf
                                  image_url:
                                    type: string
                                    description: 当 `type` 为 `image_url` 时的图片链接
                                    example: https://example.com/my_oss/image.png
                                required:
                                  - type
                    minItems: 1
              custom_variables:
                allOf:
                  - description: 智能体扩展参数。根据不同智能体的需求提供相应的参数配置。
                    oneOf:
                      - title: 通用翻译智能体
                        $ref: '#/components/schemas/TranslationAgentCustomVariables'
                      - title: 自定义智能体扩展
                        $ref: '#/components/schemas/CustomAgentCustomVariables'
            required: true
            refIdentifier: '#/components/schemas/AgentRequest'
            requiredProperties:
              - agent_id
              - messages
        examples:
          example:
            value:
              agent_id: general_translation
              stream: false
              messages:
                - role: user
                  content: 请帮我翻译这段文字：Hello World
              custom_variables:
                source_lang: en
                target_lang: zh-CN
                strategy: general
                strategy_config:
                  general:
                    suggestion: 专业技术文档翻译风格
  response:
    '200':
      application/json:
        schemaArray:
          - type: object
            properties:
              id:
                allOf:
                  - type: string
                    description: 请求唯一标识
              agent_id:
                allOf:
                  - type: string
                    description: 智能体唯一标识
              conversation_id:
                allOf:
                  - type: string
                    description: 对话唯一标识
              async_id:
                allOf:
                  - type: string
                    description: 异步任务唯一标识（异步调用时出现）
              choices:
                allOf:
                  - type: array
                    description: 智能体响应列表。
                    items:
                      type: object
                      properties:
                        index:
                          type: integer
                          description: 结果索引。
                        messages:
                          type: array
                          description: 智能体生成的响应消息列表。
                          items:
                            type: object
                            properties:
                              role:
                                type: string
                                description: 响应角色，通常为 `assistant`。
                                example: assistant
                              content:
                                oneOf:
                                  - type: string
                                    description: 智能体生成的响应内容（纯文本格式）。
                                  - type: object
                                    description: 单个多模态响应内容，用于响应只有一个元素的情况
                                    properties:
                                      type:
                                        type: string
                                        description: 内容类型，可以是文本、文件、图片、音频或视频
                                        enum:
                                          - text
                                          - file_url
                                          - image_url
                                          - audio_url
                                          - video_url
                                      text:
                                        type: string
                                        description: 当 `type` 为 `text` 时的文本内容
                                      file_url:
                                        type: string
                                        description: 当 `type` 为 `file_url` 时的文件链接
                                      image_url:
                                        type: string
                                        description: 当 `type` 为 `image_url` 时的图片链接
                                      audio_url:
                                        type: string
                                        description: 当 `type` 为 `audio_url` 时的音频链接
                                      video_url:
                                        type: string
                                        description: 当 `type` 为 `video_url` 时的视频链接
                                    required:
                                      - type
                                  - type: array
                                    description: 多模态响应内容数组，支持文本、文件、图片、音频和视频
                                    items:
                                      type: object
                                      properties:
                                        type:
                                          type: string
                                          description: 内容类型，可以是文本、文件、图片、音频或视频
                                          enum:
                                            - text
                                            - file_url
                                            - image_url
                                            - audio_url
                                            - video_url
                                        text:
                                          type: string
                                          description: 当 `type` 为 `text` 时的文本内容
                                        file_url:
                                          type: string
                                          description: 当 `type` 为 `file_url` 时的文件链接
                                        image_url:
                                          type: string
                                          description: 当 `type` 为 `image_url` 时的图片链接
                                        audio_url:
                                          type: string
                                          description: 当 `type` 为 `audio_url` 时的音频链接
                                        video_url:
                                          type: string
                                          description: 当 `type` 为 `video_url` 时的视频链接
                                      required:
                                        - type
                        finish_reason:
                          type: string
                          description: >-
                            响应结束原因。可能的取值为
                            正常结束-`stop`、长度达到上限-`length`、内容敏感-`sensitive` 或
                            网络错误-`network_error`。
              usage:
                allOf:
                  - $ref: '#/components/schemas/UsageStatistics'
            refIdentifier: '#/components/schemas/AgentResponse'
        examples:
          example:
            value:
              id: <string>
              agent_id: <string>
              conversation_id: <string>
              async_id: <string>
              choices:
                - index: 123
                  messages:
                    - role: assistant
                      content: <string>
                  finish_reason: <string>
              usage:
                prompt_tokens: 123
                completion_tokens: 123
                total_tokens: 123
        description: 业务处理成功
    default:
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - required:
                      - code
                      - message
                    type: object
                    properties:
                      code:
                        type: string
                      message:
                        type: string
            refIdentifier: '#/components/schemas/Error'
        examples:
          example:
            value:
              error:
                code: <string>
                message: <string>
        description: 请求失败。
  deprecated: false
  type: path
components:
  schemas:
    TranslationAgentCustomVariables:
      type: object
      description: 当前为 [通用翻译智能体](/cn/guide/agents/translation) `general_translation` 扩展参数预设
      properties:
        source_lang:
          type: string
          description: 待翻译文本的源语言代码，默认值为 `auto`
          default: auto
          enum:
            - auto
            - zh-CN
            - zh-TW
            - wyw
            - yue
            - en
            - ja
            - ko
            - fr
            - de
            - es
            - ru
            - pt
            - it
            - ar
            - hi
            - bg
            - cs
            - da
            - el
            - et
            - fi
            - hu
            - id
            - lt
            - lv
            - nl
            - 'no'
            - pl
            - ro
            - sk
            - sl
            - sv
            - th
            - tr
            - uk
            - vi
            - my
            - ms
            - Pinyin
            - IPA
        target_lang:
          type: string
          description: 待翻译文本的目标语言代码，默认为 `zh-CN`
          default: zh-CN
          enum:
            - zh-CN
            - zh-TW
            - wyw
            - yue
            - en
            - en-GB
            - en-US
            - ja
            - ko
            - fr
            - de
            - es
            - ru
            - pt
            - it
            - ar
            - hi
            - bg
            - cs
            - da
            - el
            - et
            - fi
            - hu
            - id
            - lt
            - lv
            - nl
            - 'no'
            - pl
            - ro
            - sk
            - sl
            - sv
            - th
            - tr
            - uk
            - vi
            - my
            - ms
            - Pinyin
            - IPA
        glossary:
          type: string
          description: 术语表`id`
        strategy:
          type: string
          description: 翻译策略
          default: general
          enum:
            - general
            - paraphrase
            - two_step
            - three_step
            - reflection
            - cot
        strategy_config:
          type: object
          description: 翻译策略对应的参数
          properties:
            general:
              type: object
              description: 当翻译策略指定为`general`时生效
              properties:
                suggestion:
                  type: string
                  description: 翻译建议或风格要求，如术语对照、文体规范等
            cot:
              type: object
              description: 当翻译策略指定为`cot`时生效
              properties:
                reason_lang:
                  type: string
                  description: 翻译理由的语言，取值 ["from"｜"to"]，默认 "to"
                  default: to
                  enum:
                    - from
                    - to
      example:
        source_lang: en
        target_lang: zh-CN
        strategy: general
        strategy_config:
          general:
            suggestion: 专业技术文档翻译风格
    CustomAgentCustomVariables:
      type: object
      description: 自定义其它智能体的扩展参数，具体参数字段可参考对应的[智能体文档](/cn/guide/agents/translation)
      additionalProperties: true
      example:
        custom_param1: value1
        custom_param2: 42
        options:
          detailed: true
          format: json
    UsageStatistics:
      type: object
      description: 调用结束时返回的 `Token` 使用统计。
      properties:
        prompt_tokens:
          type: integer
          description: 用户输入的 `Token` 数量
        completion_tokens:
          type: integer
          description: 输出的 `Token` 数量
        total_tokens:
          type: integer
          description: '`Token` 总数'

````